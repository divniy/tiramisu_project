<h2>Sign up</h2>

<%= simple_form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => {:class => 'form-horizontal'}) do |f| %>
  <p><%= f.error_notification %></p>


    <%= f.input :fullname, :autofocus => true %>
    <%= f.input :email, :required => true %>
    
    <% #TODO move following methods calls to custom devise controller %>
    <%
       if resource.accounts.empty?
         resource.accounts.build

       end
       @roles = resource.accounts.roles
    %>

    <%= f.simple_fields_for :accounts do |acc| %>
        <% # acc.input :name, :as => :hidden, :wrapper => false, :tag_html => false, :input_html => { :value => "New Account" } %>
        <%= acc.input_field :name, :as => :hidden, :value => "New Account" %>
        <%= acc.input :role, :collection => @roles, :required => true %>
    <% end %>

    <%= f.input :password, :required => true %>
    <%= f.input :password_confirmation, :required => true %>

  <div class="form-actions">
    <%= f.button :submit, "Sign up", :class => 'btn-large btn-primary' %> or
    <%= render "users/links" %>
  </div>
<% end %>


